<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🎁😊🩷🖤💗💗😘🤍</title>
<style>
body, html {
  margin:0; padding:0; height:100%; background:#2c2f33;
  font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow:hidden;
}
#rain-container {
  position: fixed;
  top:0; left:0; width:100%; height:100%; pointer-events:none;
  z-index:0; overflow:hidden;
}
.raindrop {
  position: absolute;
  width:2px; height:10px;
  background: rgba(173,216,230,0.6);
  animation: fall linear infinite;
}
@keyframes fall {
  0% { transform: translateY(-10px); opacity:0.6; }
  100% { transform: translateY(100vh); opacity:0; }
}
#container {
  position: relative;
  width:100vw;
  height:100vh;
  margin:0 auto;
  z-index:1;
}
.page {
  position: absolute;
  width:100%;
  height:100%;
  background:white;
  overflow:hidden;
  top:0; left:0;
}
.page canvas {
  width:100%;
  height:100%;
  display:block;
}
</style>
</head>
<body>

<div id="rain-container"></div>
<div id="container"></div>

<audio id="flip-sound" src="./page-flip1-178322.mp3"></audio>
<audio id="rain-sound" src="./rain-weather-lightning-thunder-151314.mp3" loop></audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.7.107/pdf.min.js"></script>
<script>
const PDF_URL = './tmpqns3v6wo-decrypted.pdf';
const container = document.getElementById('container');
const flipSound = document.getElementById('flip-sound');
const rainSound = document.getElementById('rain-sound');

let pdfDoc = null;
let currentPage = 0;
let pages = [];
let rainStarted = false;

pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.7.107/pdf.worker.min.js';

// PDF yükleme
async function loadPDF() {
  pdfDoc = await pdfjsLib.getDocument(PDF_URL).promise;
  for(let i=1;i<=pdfDoc.numPages;i++){
    const pageDiv = document.createElement('div');
    pageDiv.classList.add('page');
    pageDiv.style.zIndex = pdfDoc.numPages-i+1;
    const canvas = document.createElement('canvas');
    pageDiv.appendChild(canvas);
    container.appendChild(pageDiv);
    pages.push(pageDiv);

    const page = await pdfDoc.getPage(i);
    const viewport = page.getViewport({scale:1.0});
    canvas.width = viewport.width;
    canvas.height = viewport.height;
    await page.render({canvasContext: canvas.getContext('2d'), viewport}).promise;
  }
}

// Başlangıçta sadece ilk sayfa görünür
function initPages(){
  pages.forEach((p,i)=> p.style.display = i===0 ? 'block':'none');
}

// Sayfa geçişleri
function turnNext(){
  if(currentPage < pages.length-1){
    pages[currentPage].style.display = 'none';
    currentPage++;
    pages[currentPage].style.display = 'block';
    flipSound.play();
  }
}
function turnPrev(){
  if(currentPage > 0){
    pages[currentPage].style.display = 'none';
    currentPage--;
    pages[currentPage].style.display = 'block';
    flipSound.play();
  }
}

// Yağmur efekti
function createRain() {
  const container = document.getElementById('rain-container');
  const drops = 150;
  for(let i=0;i<drops;i++){
    const drop = document.createElement('div');
    drop.className = 'raindrop';
    drop.style.left = Math.random()*100 + 'vw';
    drop.style.animationDuration = (0.5+Math.random()*2)+'s';
    drop.style.animationDelay = (Math.random()*5)+'s';
    container.appendChild(drop);
  }
}

// Yağmur başlatma ve sesi
function startRain(){
  createRain();
  try { rainSound.play(); } catch(e){ console.warn(e); }
}

// Mobil tıklama ve dokunma
function setupNavigation(){
  const handleTouch = (x) => {
    if(!rainStarted){
      startRain();
      rainStarted = true;
    }
    if(x > window.innerWidth/2) turnNext();
    else turnPrev();
  }
  document.addEventListener('touchstart', e => handleTouch(e.touches[0].clientX));
  document.addEventListener('click', e => handleTouch(e.clientX));
}

window.onload = async () => {
  await loadPDF();
  initPages();
  setupNavigation();
}
</script>

</body>
</html>
